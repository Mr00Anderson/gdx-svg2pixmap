machine:
  java:
    version: oraclejdk8
dependencies:
  cache_directories:
    - "/home/ubuntu/.gradle/caches"
    - "/home/ubuntu/.gradle/wrapper"
  override:
    - chmod -R 777 . && git submodule update --init && ./gradlew buildEnvironment
test:
  override:
    - chmod -R 777 . && ./gradlew test && ./gradlew core:publish
  post:
    - mkdir -p $CIRCLE_TEST_REPORTS/junit/
    - find . -type f -regex ".*/build/test-results/.*xml" -exec cp {} $CIRCLE_TEST_REPORTS/junit/ \;
